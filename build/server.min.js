!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){function t(n){if(r[n])return r[n].exports;var u=r[n]={exports:{},id:n,loaded:!1};return e[n].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){(function(e,n){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}function i(t){e.log("DEBUG DEBUG connect to db: "+g.default.DATABASE_URL),l.default.connect(g.default.DATABASE_URL,function(r){return r&&t?t(r):(e.log("Debug debug port from environmet: 3001"),void(w=_.listen(g.default.PORT,function(){e.log("Listening on localhost:"+g.default.PORT),t&&t()})))})}Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),s=u(o),a=r(7),l=u(a),d=r(8),f=u(d),c=r(9),p=u(c),m=r(10),y=u(m),h=r(15),b=u(h),v=r(19),g=u(v),w=void 0;r.c[0]===n&&i(function(t){t&&e.error(t)});var _=(0,s.default)(),N=f.default.json(),q=f.default.urlencoded({extended:!0});_.use(N),_.use(q),_.use(b.default.initialize()),_.use(s.default.static("client/build")),_.use(function(t,r,n,u){e.error("DEBUG DEBUG error handling: "+t),n.status(500).send({status:500,error:t,type:"internal"})}),_.post("/login",b.default.authenticate("local",{failWithError:!0}),function(t,r){var n=t.body.username;y.default.findOne({username:n},function(t,n){return e.log("DEBUG login user found: "+JSON.stringify(n)),r.status(201).json(n)})},function(e,t,r,n){return r.json(e)}),_.post("/users",function(t,r){if(!t.body)return r.status(400).json({message:"No request body"});if(!("username"in t.body))return r.status(422).json({message:"Missing field: username"});var n=t.body.username;if(e.error("DEBUG DEBUG users post 1: "+n),"string"!=typeof n)return r.status(422).json({message:"Incorrect field type: username"});if(n=n.trim(),""===n)return r.status(422).json({message:"Incorrect field length: username"});if(!("password"in t.body))return r.status(422).json({message:"Missing field: password"});var u=t.body.password;return e.error("DEBUG DEBUG users post 2: "+u),"string"!=typeof u?r.status(422).json({message:"Incorrect field type: password"}):(u=u.trim(),""===u?r.status(422).json({message:"Incorrect field length: password"}):void p.default.genSalt(10,function(i,o){return i?(e.error("DEBUG DEBUG users post 3: "+i),r.status(500).json({message:"salt error"+i})):void p.default.hash(u,o,function(u,i){if(u)return e.error("DEBUG DEBUG users post 4: "+u),r.status(500).json({message:"encryption error"+u});var o=t.body.firstname,s=t.body.lastname;e.error("DEBUG DEBUG users post 5: "+o),e.error("DEBUG DEBUG users post 6: "+s);var a=[{assets:[{type:"",description:"",net_value:0,index:0}],liabilities:[{type:"",description:"",remaining_amount:0,index:0}],stats:[{net:0,totalDebt:0,totalAssets:0}]}],l=new y.default({username:n,password:i,firstname:o,lastname:s,currentNetworth:a,netWorth:[{year:(new Date).getUTCFullYear(),month:(new Date).getUTCMonth(),details:a}]});l.save(function(t){return t?(e.error("DEBUG DEBUG users post 7: "+t),r.status(500).json({message:"Database Error"})):(e.log("DEBUG with init networh "+JSON.stringify(l)),r.status(201).json(l))})})}))}),_.put("/liability",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.liabilityIndex,u=e.body.fieldName,i=e.body.fieldValue;y.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].liabilities.length>n){var o=r.currentNetworth[0].liabilities[n];o[u]=i}var s=r.currentNetworth[0].liabilities[r.currentNetworth[0].liabilities.length-1];return""==s.type&&""==s.description&&0==s.remaining_amount||r.currentNetworth[0].liabilities.push({type:"",description:"",remaining_amount:0,index:s.index+1}),r.save(),t.status(200).json(r)})}),_.delete("/liability",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.liabilityIndex;y.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].liabilities.length>n){var u=r.currentNetworth[0].liabilities[n];u.remove()}var i={type:"",description:"",remaining_amount:0};if(0==r.currentNetworth[0].liabilities.length)i.index=0,r.currentNetworth[0].liabilities.push(i);else{var o=r.currentNetworth[0].liabilities[r.currentNetworth[0].liabilities.length-1];""==o.type&&""==o.description&&0==o.remaining_amount||(i.index=o.index+1,r.currentNetworth[0].liabilities.push(i))}return r.save(),t.status(200).json(r)})}),_.put("/asset",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.assetIndex,u=e.body.fieldName,i=e.body.fieldValue;y.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].assets.length>n){var o=r.currentNetworth[0].assets[n];o[u]=i}var s=r.currentNetworth[0].assets[r.currentNetworth[0].assets.length-1];return""==s.type&&""==s.description&&0==s.net_value||r.currentNetworth[0].assets.push({type:"",description:"",net_value:0,index:s.index+1}),r.save(),t.status(200).json(r)})}),_.delete("/asset",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.assetIndex;y.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].assets.length>n){var u=r.currentNetworth[0].assets[n];u.remove()}var i={type:"",description:"",net_value:0};if(0==r.currentNetworth[0].assets.length)i.index=0,r.currentNetworth[0].assets.push(i);else{var o=r.currentNetworth[0].assets[r.currentNetworth[0].assets.length-1];""==o.type&&""==o.description&&0==o.net_value||(i.index=o.index+1,r.currentNetworth[0].assets.push(i))}return r.save(),t.status(200).json(r)})}),t.default=_}).call(t,r(1),r(5)(e))},function(e,t,r){(function(t){function n(){}function u(){c.log.apply(c,arguments)}function i(){c.log.apply(c,arguments)}function o(){c.warn.apply(c,arguments)}function s(e){b[e]=y()}function a(e){var t=b[e];if(!t)throw new Error("No such label: "+e);var r=y()-t;c.log(e+": "+r+"ms")}function l(){var e=new Error;e.name="Trace",e.message=p.format.apply(null,arguments),c.error(e.stack)}function d(e){c.log(p.inspect(e)+"\n")}function f(e){if(!e){var t=h.call(arguments,1);m.ok(!1,p.format.apply(null,t))}}var c,p=r(2),m=r(3),y=r(4),h=Array.prototype.slice,b={};c="undefined"!=typeof t&&t.console?t.console:"undefined"!=typeof window&&window.console?window.console:{};for(var v=[[n,"log"],[u,"info"],[i,"warn"],[o,"error"],[s,"time"],[a,"timeEnd"],[l,"trace"],[d,"dir"],[f,"assert"]],g=0;g<v.length;g++){var w=v[g],_=w[0],N=w[1];c[N]||(c[N]=_)}e.exports=c}).call(t,function(){return this}())},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("assert")},function(e,t){e.exports=require("date-now")},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("bcryptjs")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(7),i=n(u),o=r(9),s=n(o),a=r(11),l=n(a),d=new i.default.Schema({username:{type:String,required:!0,unique:!0},firstname:{type:String,required:!1,unique:!1},lastname:{type:String,required:!1,unique:!1},password:{type:String,required:!0},currentNetworth:[l.default],netWorth:[{year:Number,month:Number,details:[l.default]}]});d.methods.validatePassword=function(e,t){s.default.compare(e,this.password,function(e,r){return e?void t(e):void t(null,r)})};var f=i.default.model("User",d);t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(7),i=n(u),o=r(12),s=n(o),a=r(13),l=n(a),d=r(14),f=n(d),c=new i.default.Schema({liabilities:[s.default],assets:[l.default],stats:[f.default]});i.default.model("Networth",c);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(7),i=n(u),o=new i.default.Schema({type:{type:String,required:!1},description:{type:String,required:!1,unique:!1},remaining_amount:{type:Number,required:!1,unique:!1},index:{type:Number,required:!0,unique:!0}});i.default.model("Liability",o);t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(7),i=n(u),o=new i.default.Schema({type:{type:String,required:!1},description:{type:String,required:!1,unique:!1},net_value:{type:Number,required:!1,unique:!1},index:{type:Number,required:!0,unique:!0}});i.default.model("Asset",o);t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(7),i=n(u),o=new i.default.Schema({net:{type:Number,required:!1},totalDebt:{type:Number,required:!1,unique:!1},totalAssets:{type:Number,required:!1,unique:!1}});i.default.model("Stats",o);t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(16),i=n(u),o=r(17),s=n(o),a=r(18),l=n(a),d=r(10),f=n(d),c=(s.default.BasicStrategy,l.default.Strategy),p=new c("local",function(e,t,r){f.default.findOne({username:e},function(e,n){return e?r(e):n?void n.validatePassword(t,function(e,t){return null===e&&t?r(null,n):r('{"error":"Invalid Password"}',!1)}):r('{"error":"User does not exist"}',!1)})});i.default.serializeUser(function(e,t){t(null,e.id)}),i.default.deserializeUser(function(e,t){f.default.findById(e,function(e,r){t(e,r)})}),i.default.use(p),t.default=i.default},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-http")},function(e,t){e.exports=require("passport-local")},function(e,t,r){(function(e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={DATABASE_URL:e.env.DATABASE_URL||r.DATABASE_URL||"mongodb://localhost/worthysum-dev",PORT:"3001"}}).call(t,r(20),function(){return this}())},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function u(e){if(d===setTimeout)return setTimeout(e,0);if((d===r||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function o(){y&&p&&(y=!1,p.length?m=p.concat(m):h=-1,m.length&&s())}function s(){if(!y){var e=u(o);y=!0;for(var t=m.length;t;){for(p=m,m=[];++h<t;)p&&p[h].run();h=-1,t=m.length}p=null,y=!1,i(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var d,f,c=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:r}catch(e){d=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var p,m=[],y=!1,h=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new a(e,t)),1!==m.length||y||u(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=l,c.addListener=l,c.once=l,c.off=l,c.removeListener=l,c.removeAllListeners=l,c.emit=l,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}}]));
//# sourceMappingURL=server.min.js.map