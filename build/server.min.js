!function(e,t){for(var r in t)e[r]=t[r]}(exports,function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){(function(e,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(t){e.log("DEBUG DEBUG connect to db: "+w.default.DATABASE_URL),l.default.connect(w.default.DATABASE_URL,function(r){return r&&t?t(r):(e.log("Debug debug port from environmet: 3001"),void(g=_.listen(w.default.PORT,function(){e.log("Listening on localhost:"+w.default.PORT),t&&t()})))})}Object.defineProperty(t,"__esModule",{value:!0});var u=r(6),s=i(u),a=r(7),l=i(a),d=r(8),f=i(d),c=r(9),p=i(c),y=r(10),m=i(y),h=r(15),v=i(h),b=r(19),w=i(b),g=void 0;r.c[0]===n&&o(function(t){t&&e.error(t)});var _=(0,s.default)(),N=f.default.json(),q=f.default.urlencoded({extended:!0});_.use(N),_.use(q),_.use(v.default.initialize()),_.use(s.default.static("client/build")),_.use(function(t,r,n,i){e.error("DEBUG DEBUG error handling: "+t),n.status(500).send({status:500,error:t,type:"internal"})}),_.post("/login",v.default.authenticate("local",{failWithError:!0}),function(t,r){var n=t.body.username;m.default.findOne({username:n},function(t,n){return e.log("DEBUG login user found: "+JSON.stringify(n)),r.status(201).json(n)})},function(e,t,r,n){return r.json(e)}),_.post("/users",function(t,r){if(!t.body)return r.json('{"error":"Invalid Request"}');if(!("username"in t.body))return r.json('{"error":"Email is required"}');var n=t.body.username;if("string"!=typeof n)return r.json('{"error":"Invalid Email"}');if(n=n.trim(),""===n)return r.json('{"error":"Invalid Email"}');if(!("password"in t.body))return r.json('{"error":"Missing Password"}');var i=t.body.password;return"string"!=typeof i?r.json('{"error":"Invalid Password"}'):(i=i.trim(),""===i?r.json('{"error":"Invalid Password"}'):void p.default.genSalt(10,function(o,u){return o?(e.error("Encryption Error: "+o),r.json('{"error":"Server Error. Notify your administrator to verify logs"}')):void p.default.hash(i,u,function(i,o){if(i)return e.error("Encryption Error: "+i),r.json('{"error":"Server Error. Notify your administrator to verify logs"}');var u=t.body.firstname,s=t.body.lastname,a=[{assets:[{type:"",description:"",net_value:0,index:0}],liabilities:[{type:"",description:"",remaining_amount:0,index:0}],stats:[{net:0,totalDebt:0,totalAssets:0}]}],l=new m.default({username:n,password:o,firstname:u,lastname:s,currentNetworth:a,netWorth:[{year:(new Date).getUTCFullYear(),month:(new Date).getUTCMonth(),details:a}]});l.save(function(e){return e?r.json('{"error":"User already exists"}'):r.status(201).json(l)})})}))}),_.put("/liability",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.liabilityIndex,i=e.body.fieldName,o=e.body.fieldValue;m.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].liabilities.length>n){var u=r.currentNetworth[0].liabilities[n];u[i]=o}var s=r.currentNetworth[0].liabilities[r.currentNetworth[0].liabilities.length-1];return""==s.type&&""==s.description&&0==s.remaining_amount||r.currentNetworth[0].liabilities.push({type:"",description:"",remaining_amount:0,index:s.index+1}),r.save(),t.status(200).json(r)})}),_.delete("/liability",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.liabilityIndex;m.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].liabilities.length>n){var i=r.currentNetworth[0].liabilities[n];i.remove()}var o={type:"",description:"",remaining_amount:0};if(0==r.currentNetworth[0].liabilities.length)o.index=0,r.currentNetworth[0].liabilities.push(o);else{var u=r.currentNetworth[0].liabilities[r.currentNetworth[0].liabilities.length-1];""==u.type&&""==u.description&&0==u.remaining_amount||(o.index=u.index+1,r.currentNetworth[0].liabilities.push(o))}return r.save(),t.status(200).json(r)})}),_.put("/asset",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.assetIndex,i=e.body.fieldName,o=e.body.fieldValue;m.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].assets.length>n){var u=r.currentNetworth[0].assets[n];u[i]=o}var s=r.currentNetworth[0].assets[r.currentNetworth[0].assets.length-1];return""==s.type&&""==s.description&&0==s.net_value||r.currentNetworth[0].assets.push({type:"",description:"",net_value:0,index:s.index+1}),r.save(),t.status(200).json(r)})}),_.delete("/asset",function(e,t){if(!e.body)return t.status(400).json({message:"No request body"});var r=e.body.username,n=e.body.assetIndex;m.default.findOne({username:r},function(e,r){if(r.currentNetworth[0].assets.length>n){var i=r.currentNetworth[0].assets[n];i.remove()}var o={type:"",description:"",net_value:0};if(0==r.currentNetworth[0].assets.length)o.index=0,r.currentNetworth[0].assets.push(o);else{var u=r.currentNetworth[0].assets[r.currentNetworth[0].assets.length-1];""==u.type&&""==u.description&&0==u.net_value||(o.index=u.index+1,r.currentNetworth[0].assets.push(o))}return r.save(),t.status(200).json(r)})}),t.default=_}).call(t,r(1),r(5)(e))},function(e,t,r){(function(t){function n(){}function i(){c.log.apply(c,arguments)}function o(){c.log.apply(c,arguments)}function u(){c.warn.apply(c,arguments)}function s(e){v[e]=m()}function a(e){var t=v[e];if(!t)throw new Error("No such label: "+e);var r=m()-t;c.log(e+": "+r+"ms")}function l(){var e=new Error;e.name="Trace",e.message=p.format.apply(null,arguments),c.error(e.stack)}function d(e){c.log(p.inspect(e)+"\n")}function f(e){if(!e){var t=h.call(arguments,1);y.ok(!1,p.format.apply(null,t))}}var c,p=r(2),y=r(3),m=r(4),h=Array.prototype.slice,v={};c="undefined"!=typeof t&&t.console?t.console:"undefined"!=typeof window&&window.console?window.console:{};for(var b=[[n,"log"],[i,"info"],[o,"warn"],[u,"error"],[s,"time"],[a,"timeEnd"],[l,"trace"],[d,"dir"],[f,"assert"]],w=0;w<b.length;w++){var g=b[w],_=g[0],N=g[1];c[N]||(c[N]=_)}e.exports=c}).call(t,function(){return this}())},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("assert")},function(e,t){e.exports=require("date-now")},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("bcryptjs")},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=n(i),u=r(9),s=n(u),a=r(11),l=n(a),d=new o.default.Schema({username:{type:String,required:!0,unique:!0},firstname:{type:String,required:!1,unique:!1},lastname:{type:String,required:!1,unique:!1},password:{type:String,required:!0},currentNetworth:[l.default],netWorth:[{year:Number,month:Number,details:[l.default]}]});d.methods.validatePassword=function(e,t){s.default.compare(e,this.password,function(e,r){return e?void t(e):void t(null,r)})};var f=o.default.model("User",d);t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=n(i),u=r(12),s=n(u),a=r(13),l=n(a),d=r(14),f=n(d),c=new o.default.Schema({liabilities:[s.default],assets:[l.default],stats:[f.default]});o.default.model("Networth",c);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=n(i),u=new o.default.Schema({type:{type:String,required:!1},description:{type:String,required:!1,unique:!1},remaining_amount:{type:Number,required:!1,unique:!1},index:{type:Number,required:!0,unique:!1}});o.default.model("Liability",u);t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=n(i),u=new o.default.Schema({type:{type:String,required:!1},description:{type:String,required:!1,unique:!1},net_value:{type:Number,required:!1,unique:!1},index:{type:Number,required:!0,unique:!1}});o.default.model("Asset",u);t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),o=n(i),u=new o.default.Schema({net:{type:Number,required:!1},totalDebt:{type:Number,required:!1,unique:!1},totalAssets:{type:Number,required:!1,unique:!1}});o.default.model("Stats",u);t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(16),o=n(i),u=r(17),s=n(u),a=r(18),l=n(a),d=r(10),f=n(d),c=(s.default.BasicStrategy,l.default.Strategy),p=new c("local",function(e,t,r){f.default.findOne({username:e},function(e,n){return e?r(e):n?void n.validatePassword(t,function(e,t){return null===e&&t?r(null,n):r('{"error":"Invalid Password"}',!1)}):r('{"error":"User does not exist"}',!1)})});o.default.serializeUser(function(e,t){t(null,e.id)}),o.default.deserializeUser(function(e,t){f.default.findById(e,function(e,r){t(e,r)})}),o.default.use(p),t.default=o.default},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("passport-http")},function(e,t){e.exports=require("passport-local")},function(e,t,r){(function(e,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={DATABASE_URL:e.env.DATABASE_URL||r.DATABASE_URL||"mongodb://localhost/worthysum-dev",PORT:"3001"}}).call(t,r(20),function(){return this}())},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(d===setTimeout)return setTimeout(e,0);if((d===r||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function u(){m&&p&&(m=!1,p.length?y=p.concat(y):h=-1,y.length&&s())}function s(){if(!m){var e=i(u);m=!0;for(var t=y.length;t;){for(p=y,y=[];++h<t;)p&&p[h].run();h=-1,t=y.length}p=null,m=!1,o(e)}}function a(e,t){this.fun=e,this.array=t}function l(){}var d,f,c=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:r}catch(e){d=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var p,y=[],m=!1,h=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];y.push(new a(e,t)),1!==y.length||m||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=l,c.addListener=l,c.once=l,c.off=l,c.removeListener=l,c.removeAllListeners=l,c.emit=l,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}}]));
//# sourceMappingURL=server.min.js.map